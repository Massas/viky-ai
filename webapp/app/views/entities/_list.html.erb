<% threshold = 2000 %>
<div class="card card--warning" <% if @entities_list.entities_count < threshold %>style="display:none;"<% end %>>
  <div class="card-content">
    <span class="icon">
      <%= icon_alert %>
    </span>
    <%= t('views.entities_lists.show.limit_exceeded', limit: threshold, total: @entities_list.entities_count) %>
  </div>
</div>

<ul id="entities-list" class="card-list"
    data-behavior="sortable"
    data-update-positions-path="<%= update_positions_user_agent_entities_list_entities_path(@agent.owner, @agent, @entities_list) %>"
    data-key='ids'>
  <%= render partial: 'entities/entity',
             collection: @entities_list.entities.order(position: :desc, created_at: :desc).limit(threshold),
             locals: {
               can_edit: current_user.can?(:edit, agent),
               entities_list: @entities_list,
               agent: @entities_list.agent,
               owner: @entities_list.agent.owner
            }
  %>
</ul>
